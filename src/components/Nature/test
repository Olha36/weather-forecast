'use client';
/* eslint-disable @next/next/no-img-element */
import {
  Box,
  CircularProgress,
  Typography,
  useTheme,
  useMediaQuery,
} from '@mui/material';
import { useNature } from '../../lib/hooks/useNature';
import '../../css/nature.css';
import { Swiper, SwiperSlide } from 'swiper/react';
import 'swiper/css';
import 'swiper/css/effect-coverflow';
import 'swiper/css/pagination';
import { A11y, EffectCoverflow, Pagination, Scrollbar } from 'swiper/modules'; // removed Navigation

export default function Nature() {
  const { data, loading, error } = useNature();
  const theme = useTheme();

  // Detect tablet and mobile breakpoints
  const isTablet = useMediaQuery(theme.breakpoints.down('md')); // <= 960px
  const isMobile = useMediaQuery(theme.breakpoints.down('sm')); // <= 600px

  if (loading)
    return (
      <Box
        display="flex"
        justifyContent="center"
        alignItems="center"
        height="50vh"
      >
        <CircularProgress />
      </Box>
    );

  if (error)
    return (
      <Typography color="error" textAlign="center">
        {error}
      </Typography>
    );

  return (
    <Box
      sx={{
        width: '100%',
        minHeight: isMobile ? '50vh' : '40vh',
        overflow: 'hidden',
        position: 'relative',
        backgroundColor: '#f5f5f5',
        py: isMobile ? 3 : 2,
      }}
    >
      <Typography
        variant={isMobile ? 'subtitle2' : 'subtitle1'}
        sx={{ textAlign: 'center', mb: isMobile ? 2 : 3 }}
      >
        Beautiful nature
      </Typography>

      <Box
        sx={{
          position: 'relative',
          width: '100%',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          cursor: 'grab',
          px: isMobile ? 1 : 5,
        }}
      >
        <Swiper
          effect={'coverflow'}
          modules={[Pagination, Scrollbar, A11y, EffectCoverflow]}
          spaceBetween={isMobile ? 20 : isTablet ? 30 : 50}
          slidesPerView={isMobile ? 1 : isTablet ? 2 : 3}
          coverflowEffect={{
            rotate: 50,
            stretch: 0,
            depth: 100,
            modifier: 1,
            slideShadows: true,
          }}
          pagination={{ clickable: true }}
          scrollbar={{ draggable: true }}
          className="mySwiper"
          style={{ paddingBottom: isMobile ? '40px' : '50px' }} // add extra space for pagination
        >
          {data.map((img, index) => (
            <SwiperSlide key={index}>
              <Box
                component="img"
                src={img.image}
                alt={`Slide ${index}`}
                sx={{
                  width: '100%',
                  height: isMobile ? '200px' : '250px',
                  objectFit: 'cover',
                  borderRadius: 2,
                  boxShadow: 3,
                }}
              />
            </SwiperSlide>
          ))}
        </Swiper>
      </Box>
    </Box>
  );
}
